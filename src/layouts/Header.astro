---
import ContentWidth from "../components/ui/ContentWidth.astro";

const navLinks = [
  { name: "Inicio", href: "/" },
  { name: "Servicios", href: "/#services" },
  { name: "Atención", href: "/#chanel-services" },
  { name: "Nosotros", href: "/#about-us" },
  { name: "Contacto", href: "/contact" },
];
---

<header id="main-header" class="fixed top-0 left-0 w-full z-[100] transition-all duration-300 border-b border-white/5 bg-[#050505]/80 backdrop-blur-md">
  <ContentWidth>
    <div id="header-inner" class="flex items-center justify-between h-20 md:h-24 transition-all duration-300">

      <div class="flex-shrink-0 z-[120]">
        <a href="/" class="block group relative">
          <div class="absolute -inset-2 bg-yellow-400/20 rounded-full blur-xl opacity-0 group-hover:opacity-100 transition-opacity"></div>
          <img src="/images/logo.webp" alt="Logo Proyectores Servitec" class="h-8 md:h-10 w-auto relative" />
        </a>
      </div>

      <nav class="hidden lg:block">
        <ul class="flex items-center gap-2">
          {navLinks.map((link) => (
            <li>
              <a href={link.href} class="relative px-4 py-2 text-[11px] font-bold uppercase tracking-[0.15em] text-white/70 hover:text-white transition-colors group">
                {link.name}
                <span class="absolute bottom-0 left-4 right-4 h-[2px] bg-yellow-400 scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-300"></span>
              </a>
            </li>
          ))}
        </ul>
      </nav>

      <div class="flex items-center gap-4 z-[120]">
        <a href="https://wa.me/51941801827" class="hidden sm:inline-flex relative overflow-hidden group items-center gap-3 rounded-full bg-yellow-400 px-7 py-3 text-[11px] font-black uppercase tracking-[0.1em] text-black transition-all">
          <span class="relative z-10">Soporte Técnico</span>
        </a>

        <button id="menu-toggle" class="lg:hidden relative h-12 w-12 text-white flex items-center justify-center rounded-full bg-white/5 transition-colors" aria-label="Menú">
          <div class="flex flex-col gap-1.5 w-6 pointer-events-none">
            <span id="line-1" class="h-0.5 w-full bg-white transition-all duration-300"></span>
            <span id="line-2" class="h-0.5 w-full bg-yellow-400 transition-all duration-300"></span>
          </div>
        </button>
      </div>
    </div>
  </ContentWidth>

  <div
    id="mobile-menu"
    class="fixed inset-0 w-full h-screen bg-[#050505] flex flex-col items-center justify-center lg:hidden"
    style="visibility: hidden; opacity: 0; transform: translateX(100%); transition: all 0.3s ease-out;"
  >
    <nav class="flex flex-col items-center gap-6 relative z-10 w-full px-10 text-center">
      {navLinks.map((link) => (
        <a href={link.href} class="mobile-link text-3xl font-black uppercase tracking-widest text-yellow-400 py-3 w-full border-b border-white/5 last:border-0">
          {link.name}
        </a>
      ))}

      <a href="https://wa.me/51941801827" class="mt-8 w-full max-w-[280px] rounded-2xl bg-yellow-400 px-6 py-5 text-[11px] font-black uppercase text-black tracking-[0.2em] shadow-lg shadow-yellow-400/20 active:scale-95 transition-transform">
        WhatsApp Directo
      </a>
    </nav>
  </div>
</header>

<style>
  :global(body.no-scroll) { overflow: hidden !important; }

  #mobile-menu.active {
    visibility: visible !important;
    opacity: 1 !important;
    transform: translateX(0) !important;
    z-index: 105;
  }

  .menu-active #line-1 { transform: translateY(4.5px) rotate(45deg); }
  .menu-active #line-2 { transform: translateY(-4px) rotate(-45deg); }

  .mobile-link {
    transition: color 0.2s ease;
  }

  .mobile-link:active {
    color: white;
    background-color: rgba(255, 255, 255, 0.05);
  }
</style>

<script>
  const menuToggle = document.getElementById('menu-toggle');
  const mobileMenu = document.getElementById('mobile-menu');

  function toggleMenu() {
    const isOpen = mobileMenu?.classList.toggle('active');
    menuToggle?.classList.toggle('menu-active', isOpen);

    if (isOpen) {
      document.body.classList.add('no-scroll');
    } else {
      document.body.classList.remove('no-scroll');
    }
  }

  menuToggle?.addEventListener('click', (e) => {
    e.preventDefault();
    toggleMenu();
  });

  mobileMenu?.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      mobileMenu.classList.remove('active');
      menuToggle?.classList.remove('menu-active');
      document.body.classList.remove('no-scroll');
    });
  });

  window.addEventListener('scroll', () => {
    const headerInner = document.getElementById('header-inner');
    const mainHeader = document.getElementById('main-header');
    if (window.scrollY > 40) {
      if (headerInner) headerInner.style.height = '64px';
      mainHeader?.classList.add('bg-[#050505]/95');
    } else {
      if (headerInner) headerInner.style.height = '';
      mainHeader?.classList.remove('bg-[#050505]/95');
    }
  });
</script>